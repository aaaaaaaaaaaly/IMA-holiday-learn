```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
```



#### 先处理数据


```python
from sklearn.datasets import load_diabetes
# 从sklearn库数据集里面导入糖尿病数据集,糖尿病数据集叫load_diabetes()

#数据命名
diabetes=load_diabetes()
# 打印观察，发现有data，feature_names，target
#变量赋值,获取一维数据
data=diabetes['data']
fname=diabetes['feature_names']
target=diabetes['target']
df=pd.DataFrame(data,columns=fname)
```



**思路：**

根据公式求出theta。

首先把数据集要测试的数据拉下来，type转化为列表，注意x需要补充1；

接着初始化theta，根据公式求出theta

由求出的theta，y=theta*x+b,画线



**代码实现（成功）**


```python
plt.figure(figsize=(8,5))
plt.plot(df['bmi'],df.index,'g*')
plt.title('bmi')
#以下的操作都需要将他们转化为列表,tolist方法
x=df['bmi'].tolist()
y=df.index.tolist()
#转化为矩阵
#创建一个空列表
z=[]
# 报错：asmatrix() missing 1 required positional argument: 'data'，所以要在第一列补上1
for i in range(len(x)):
    z.append(1)
# 报错：'float' object has no attribute 'insert'，所以要用两个列表合并的方法zip
X=[list(i) for i in zip(z,x)]
X=np.mat(X)
Y=np.mat(y)
theta=[[0],[0]]
#初始化theta
theta=np.linalg.inv(X.T*X)*X.T*Y.T#带入公式
```

**画图**

此处仍待提高

```python
theta0=theta[0]
theta1=theta[1]
#画回归方程,
x=np.linspace(df['bmi'].reshape(-1).min(),df['bmi'].reshape(-1).max(),100)
y=theta1+theta0*x
plt.plot(x,y,c='r')
```

**出现的被解决的报错：**

 报错：'float' object has no attribute 'insert'，所以要用两个列表合并的方法zip

```
for i in range(len(x)):
    z.append(1)
x=[list(i) for i in zip(z,x)]
```



**未解决报错，在把x转化为矩阵的时候出现**


    ---------------------------------------------------------------------------
    
    TypeError           Traceback (most recent call last)
    
    <ipython-input-92-5da7725e61ca> in <module>
         14 # 报错：'float' object has no attribute 'insert'，所以要用两个列表合并的方法zip
         15 x=[list(i) for i in zip(z,x)]
    ---> 16 x=np.mat()
         17 y=np.mat()
         18 theta=[[0],[0]]



**已解决，原因：x=np.mat（x）**
