```python
import numpy as np
import pandas as pd
import matplotlib as mpl
```

#### å…ˆå¤„ç†æ•°æ®


```python
from sklearn.datasets import load_diabetes
# ä»sklearnåº“æ•°æ®é›†é‡Œé¢å¯¼å…¥ç³–å°¿ç—…æ•°æ®é›†,ç³–å°¿ç—…æ•°æ®é›†å«load_diabetes()

#æ•°æ®å‘½å
diabetes=load_diabetes()
# æ‰“å°è§‚å¯Ÿï¼Œå‘ç°æœ‰dataï¼Œfeature_namesï¼Œtarget
#å˜é‡èµ‹å€¼,è·å–ä¸€ç»´æ•°æ®
data=diabetes['data']
fname=diabetes['feature_names']
target=diabetes['target']
df=pd.DataFrame(data,columns=fname)
```



#### æ­£è§„æ–¹ç¨‹

**æ€è·¯ï¼š**

æ ¹æ®å…¬å¼æ±‚å‡ºthetaã€‚

é¦–å…ˆæŠŠæ•°æ®é›†è¦æµ‹è¯•çš„æ•°æ®æ‹‰ä¸‹æ¥ï¼Œtypeè½¬åŒ–ä¸ºåˆ—è¡¨ï¼Œæ³¨æ„xéœ€è¦è¡¥å……1ï¼›

æ¥ç€åˆå§‹åŒ–thetaï¼Œæ ¹æ®å…¬å¼æ±‚å‡ºtheta

ç”±æ±‚å‡ºçš„thetaï¼Œy=theta*x+b,ç”»çº¿



**ä»£ç å®ç°ï¼ˆæˆåŠŸï¼‰**


```python
plt.figure(figsize=(8,5))
plt.plot(df['bmi'],df.index,'g*')
plt.title('bmi')
#ä»¥ä¸‹çš„æ“ä½œéƒ½éœ€è¦å°†ä»–ä»¬è½¬åŒ–ä¸ºåˆ—è¡¨,tolistæ–¹æ³•
x=df['bmi'].tolist()
y=df.index.tolist()
#è½¬åŒ–ä¸ºçŸ©é˜µ
#åˆ›å»ºä¸€ä¸ªç©ºåˆ—è¡¨
z=[]
# æŠ¥é”™ï¼šasmatrix() missing 1 required positional argument: 'data'ï¼Œæ‰€ä»¥è¦åœ¨ç¬¬ä¸€åˆ—è¡¥ä¸Š1
# æŠ¥é”™ï¼š'float' object has no attribute 'insert'ï¼Œæ‰€ä»¥è¦ç”¨ä¸¤ä¸ªåˆ—è¡¨åˆå¹¶çš„æ–¹æ³•zip
for i in range(len(x)):
    z.append(1)

X=[list(i) for i in zip(z,x)]
X=np.mat(X)
Y=np.mat(y)
theta=[[0],[0]]
#åˆå§‹åŒ–theta
theta=11#å¸¦å…¥å…¬å¼
```

**æ”¹è¿›**

åˆ†åŠŸèƒ½æ®µï¼Œ**ç”¨å‡½æ•°å®ç°**

```python
import numpy as np
import pandas as pd
import matplotlib as mpl
from sklearn.datasets import load_diabetes
# ä»sklearnåº“æ•°æ®é›†é‡Œé¢å¯¼å…¥ç³–å°¿ç—…æ•°æ®é›†,ç³–å°¿ç—…æ•°æ®é›†å«load_diabetes()

#æ•°æ®å‘½å
diabetes=load_diabetes()
# æ‰“å°è§‚å¯Ÿï¼Œå‘ç°æœ‰dataï¼Œfeature_namesï¼Œtarget
#å˜é‡èµ‹å€¼,è·å–ä¸€ç»´æ•°æ®
data_x=diabetes['data']
data_y=diabetes['target']
z=[]
for i in range((len(data_x))):
    z.append(1)
data_x=[list(i) for i in zip(z,data_x)]
def regular_experssion(data_x,data_y):
    #é¦–å…ˆå¯¹æ•°æ®è¿›è¡Œå¤„ç†,ä¼ è¿›æ¥çš„data_xï¼Œm*nï¼ˆä»æ•°æ®é›†æŠ“ä¸‹æ¥çš„åˆæ€ï¼‰
    theta=np.linalg.inv(data_x.T.dot(data_x)).dot((data_x).T.dot(data_y.T))
    #æ±‚æ–¹ç¨‹
    loss=np.mean(np.sum((data_x.dot(theta)-data_y)**2))
    return theta,loss
data_x=diabetes.data
data_y=diabetes.target
theta,loss= regular_experssion (data_x,data_y)
print(f"Implement theta:{theta}")
#æ ¼å¼åŒ–å­—ç¬¦ä¸²
print(f"Implement loss:{loss}")
```



**ç”»å›¾**

æ­¤å¤„ä»å¾…æé«˜

```python
theta0=theta[0]
theta1=theta[1]
#ç”»å›å½’æ–¹ç¨‹,
x=np.linspace(df['bmi'].reshape(-1).min(),df['bmi'].reshape(-1).max(),100)
y=theta1+theta0*x
plt.plot(x,y,c='r')
```

**å‡ºç°çš„è¢«è§£å†³çš„æŠ¥é”™ï¼š**

 æŠ¥é”™ï¼š'float' object has no attribute 'insert'ï¼Œæ‰€ä»¥è¦ç”¨ä¸¤ä¸ªåˆ—è¡¨åˆå¹¶çš„æ–¹æ³•zip

```
for i in range(len(x)):
    z.append(1)
x=[list(i) for i in zip(z,x)]
```

**æœªè§£å†³æŠ¥é”™ï¼Œåœ¨æŠŠxè½¬åŒ–ä¸ºçŸ©é˜µçš„æ—¶å€™å‡ºç°**


    TypeError           Traceback (most recent call last)
    
    <ipython-input-92-5da7725e61ca> in <module>
         14 # æŠ¥é”™ï¼š'float' object has no attribute 'insert'ï¼Œæ‰€ä»¥è¦ç”¨ä¸¤ä¸ªåˆ—è¡¨åˆå¹¶çš„æ–¹æ³•zip
         15 x=[list(i) for i in zip(z,x)]
    ---> 16 x=np.mat()
         17 y=np.mat()
         18 theta=[[0],[0]]

**å·²è§£å†³ï¼ŒæŠ¥é”™åŸå› ï¼šx=np.matï¼ˆxï¼‰**

------

#### æ¢¯åº¦ä¸‹é™å®ç°çº¿æ€§å›å½’

```python
theta=np.zeros((len(data_x[0])+1),1)#thetaåˆå§‹åŒ–ä¸ºï¼ˆn+1ï¼‰*1çš„çŸ©é˜µ,næ˜¯ç‰¹å¾æ•°
data_x=hstack(np.ones((len(data_x),1)),data_x)#data_xæ˜¯m*ï¼ˆn+1ï¼‰çŸ©é˜µ
interations=10000#è¿­ä»£æ¬¡æ•°
alpha=0.15#å­¦ä¹ ç‡
#ä»£ä»·å‡½æ•°
def costfunction(theta,data_x,data_y):
    predictvalue=data_x.dot(theta)-data_y#(m*1)
    return (predictvalue**2)/(2*len(data_x)),predictvalue#(m*1)  
#æ¢¯åº¦ä¸‹é™å‡½æ•°
def descendgradient(theta,data_x,data_y):
    costfunction(theta,data_x,data_y)
    costvector=[]#æ”¶é›†ä»£ä»·å‡½æ•°çš„å€¼
    theta_history=[]#æ”¶é›†thetaçš„å˜åŒ–
    #data_xçš„è¡Œæ•°
    m=len(data_x)
    
    for i in range(0,iterations):
        #æ¯ä¸€æ¬¡è¿­ä»£æ ¹æ®ä¸Šä¸€æ¬¡è¿­ä»£çš„thetaé‡æ–°æ›´æ–°ä»£ä»·å‡½æ•°,è®°å½•
        cost,pred=costfunction(theta,data_x,data_y)
        costvector.append(cost)
        theta_history.append(list(theta[:,0]))
        gradient=np.zeros(((len(data_x[0])+1),1))#åˆå§‹åŒ–æ¢¯åº¦
        #å¯¹äºthetaæ¥è¯´ï¼Œè¡Œæ•°å°±æ˜¯ç‰¹å¾æ•°
        #jä»£è¡¨ç‰¹å¾æ•°ï¼Œå¯¹äºdata_xæ¥è¯´å°±æ˜¯åˆ—æ•°
        #Xä»£è¡¨æ¯ä¸€åˆ—çš„é›†åˆ
        #è¿™é‡Œçš„predç”¨ åˆ—è¿˜æœªæ›´æ–° çš„pred=theta*data_x-data_y,å› ä¸ºè¦åŒæ—¶æ›´æ–°
        X=data_x.T,å˜æˆï¼ˆ1*mï¼‰
        gradient=np.sum(np.dot(predï¼Œdata_x.T))
        theta=theta-(alpha/m)*gradient

     return theta,theta_history,costvector
```

#### æ¢¯åº¦ä¸‹é™å®ç°é€»è¾‘å›å½’

çŸ¥è¯†ç†è§£ï¼š

å‡è®¾å‡½æ•°æ”¹å˜ï¼Œä»£ä»·å‡½æ•°éšä¹‹æ”¹å˜ï¼Œä¸”å˜æˆéå‡¸å‡½æ•°ã€‚

ä»£ä»·å‡½æ•°ä¼˜åŒ–ä¸ºå‡¸å‡½æ•°ï¼Œæ±‚æœ€å°ï¼š
$$
jï¼ˆthetaï¼‰=(-1/m)\sum\limits_{i=1}^m[ylog(h(x))+(1-y)log(1-h(x))]
$$
ä»£ç å®ç°ï¼š

ä»£ä»·å‡½æ•°è¡¨è¾¾å¼æ”¹å˜ï¼ŒæŒ‰ç…§ä»¥ä¸Šå…¬å¼è¿”å›ä»£ä»·å‡½æ•°å€¼

æ›´æ–°thetaæ—¶ï¼Œä¹Ÿæ— æ³•åƒçº¿æ€§å›å½’ä¸­åªéœ€è¦è®¡ç®—ä»£ä»·å‡½æ•°å°±å¯ä»¥è·å¾—predå€¼ï¼Œä»è€Œç›´æ¥ç®€åŒ–æ±‚`hx`
$$
thetaï¼š=theta-(alpha/m)\sum\limits_{i=1}^m[(hx-y)*x_j^{(i)}]
$$
è¿™ä¸ªæ›´æ–°thetaçš„å‡½æ•°æ˜¯ä¸€æ ·çš„ï¼›

ä½†æ˜¯ä»£ä»·å‡½æ•°çš„`hx`å‘ç”Ÿæ”¹å˜
$$
hx=1/(1+e^{-theta^{T}*x})
$$





#### å†³ç­–æ ‘

![](https://s4.ax1x.com/2022/01/24/7T765q.jpg)



ç®€å•å†³ç­–æ ‘çš„ç®€å•æ€è·¯ï¼š

**ç›®æ ‡æ˜¯**ï¼šæ¯ä¸€æ¬¡é€‰å‡ºç°æœ‰ç‰¹å¾ä¸­çš„ä¿¡æ¯å¢ç›Šæœ€å¤§çš„åšèŠ‚ç‚¹ï¼Œç„¶åé€’å½’æ­¤å‡½æ•°çŸ¥é“æ²¡æœ‰ç‰¹å¾æ•°

å¦‚ä¸Šå›¾ã€‚

éœ€è¦åœ¨è¿™ä¸ªæ±‚**ç°æœ‰ç‰¹å¾ä¸­çš„ä¿¡æ¯å¢ç›Šæœ€å¤§**çš„å‡½æ•°**å¤–**éœ€è¦æœ‰ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°å¯¹ä¼ å…¥çš„**dataset**ï¼Œæ±‚:
$$
H(D)=\sum\limits^n_{i=1}\frac{|C_k|}{|D|}log_2\frac{|C_k|}{|D|}
$$
å…¶å®æ±‚æŸç‰¹å¾Açš„æŸä¸ªå–å€¼ï¼ˆæ¯”å¦‚Aä»£è¡¨å¹´é¾„ï¼Œå–å€¼å…±æœ‰é’å¹´ï¼Œä¸­å¹´ï¼Œè€å¹´3ç§ï¼‰ï¼š
$$
\sum\limits^k_{i=1}\frac{|C_{ik}|}{|D_{i}|}log_2\frac{|C_{ik}|}{|D_{k}|}
$$
è¿™ä¸¤ä¸ªæ˜¯**å…±åŒ**çš„ï¼Œåªéœ€è¦æŠŠç‰¹å¾Açš„**æŸä¸ªå–å€¼**ä»åŸåˆ—ä¸­**åˆ‡å‡ºæ¥**ï¼Œåªå‰©è¿™ä¸ªå–å€¼ã€‚é‚£ä¹ˆå°±ç›¸å½“äºï¼ŒD_iï¼ŒDéƒ½ä»£è¡¨åˆ—è¡¨çš„æ ·æœ¬æ€»æ•°ï¼ŒC_k,C_{`ik`}éƒ½è¡¨ç¤ºæ±‚æ¯ç§labelå–å€¼çš„ä¸ªæ•°

```python
from math import log
#ç°åœ¨æ¥å®šä¹‰è¿™ä¸ªå¤–éƒ¨å‡½æ•°ï¼Œå› ä¸ºä¸»è¦ç®—ç»éªŒç†µï¼Œæ‰€ä»¥å«calent
def calEnt (dataset):
    #æ€è·¯ï¼šåªéœ€è¦æ±‚å‡ºlabelçš„æ ‡ç­¾ç§ç±»ï¼Œä»¥åŠæ¯ä¸€ä¸ªç§ç±»çš„ä¸ªæ•°
    #å…ˆå¯¹æ ‡ç­¾çš„ç§ç±»è¿›è¡Œç­›é€‰ï¼Œæ”¾åœ¨å­—å…¸ä¸­ï¼Œè¿™ä¸ªå­—å…¸å«labelcount
    labelcount={}
    #å¯¹labelæ ‡ç­¾è¿›è¡Œç­›é€‰
    for labels in dataset:
        currentlabel=labels[-1]#è¿™ä¸ªlabelsæ˜¯datasetçš„æ¯ä¸€è¡Œï¼Œ-1æ‰¾åˆ°æœ€åä¸€åˆ—
        if currentlabel not in labelcount.keys():
            labelcount[currentlabel]=0#æŠŠlabelçš„å–å€¼å½“åškeyï¼Œå°±æ˜¯ç±»ä¼¼æ•°ç»„çš„ä¸‹æ ‡
        labelcount[currentlabel]+=1
    #è®¡ç®—ç†µ
    Ent=0
    for key in labelcount:
        prob=labelcount[key]/len(dataset)
        Ent+=prob*log(prob,2)
    return -Ent
```



å›åˆ°è¿™ä¸ªæ±‚**ç°æœ‰ç‰¹å¾ä¸­çš„ä¿¡æ¯å¢ç›Šæœ€å¤§**çš„å‡½æ•°ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦å®ç°ä¸€æ¬¡ï¼Œç»§ç»­é€’å½’å°±å¯ä»¥è¾¾åˆ°ç§ä¸€æ£µæ ‘çš„ç›®æ ‡

- å› ä¸ºæ¶‰åŠæ±‚æ¯ä¸€ç§ç‰¹å¾çš„å¢ç›Šï¼Œæ‰€ä»¥éœ€è¦æœ‰ä¸€ä¸ªåˆ—è¡¨æ¥å­˜æ”¾æ¯ä¸€æ¬¡è¢«åˆ‡å‡ºæ¥çš„**é‚£ä¸ªç‰¹å¾å’Œæœ«å°¾çš„label**

- åˆ‡å®Œä¹‹å**è¿›å…¥**å¯¹è¿™ä¸ªç‰¹å¾æ±‚å¢ç›Šçš„**forå¾ªç¯**ï¼Œå› ä¸ºè¯¥ç‰¹å¾å¯èƒ½æœ‰ä¸åŒå–å€¼ï¼Œæ ¹æ®ï¼š

$$
H(D|A)=\sum\limits^n_{i=1}\frac{|D_i|}{|D|}\sum\limits^k_{i=1}\frac{|C_{ik}|}{|D_{i}|}log_2\frac{|C_{ik}|}{|D_{k}|}
$$

â€‹     æˆ‘ä»¬çŸ¥é“éœ€è¦è¿›è¡Œæ¯ç§å–å€¼çš„æ±‚å’Œï¼Œæ‰€ä»¥æ˜¯forå¾ªç¯ç„¶åç”¨  **+=**

â€‹      å› ä¸ºå·²ç»åˆ‡å‡ºæ¥ï¼Œæ‰€ä»¥Dæ˜“çŸ¥ï¼ŒD_iå°±éœ€è¦æˆ‘ä»¬ç»§ç»­æŠŠæ¯ç§å–å€¼ä»ç‰¹å¾Aä¸­åˆ‡å‡ºæ¥ï¼Œä¹Ÿåªå‰©ä¸‹     è¿™ä¸ªå–å€¼å’Œlabelï¼Œæ”¾åœ¨dataseté‡Œé¢ï¼Œè°ƒç”¨åˆšæ‰è¯´çš„**å¤–**éƒ¨å‡½æ•°,å¾ªç¯**+=**å³å¯ï¼Œæ±‚å‡ºæ‰€æœ‰çš„ç‰¹å¾ä¸­å¢ç›Šæœ€å¤§çš„åšèŠ‚ç‚¹**

- ç»§ç»­è°ƒç”¨æœ¬å‡½æ•°**ï¼ˆé€’å½’ï¼‰**ï¼Œå‚æ•°æ˜¯å‰©ä¸‹çš„ç‰¹å¾æ•°ï¼Œæ ·æœ¬æ€»æ•°

```python
def splitfeature (featList, value):
    splitresult=[]
    for vote in featlist:
        if vote[-1]==value:
            splitresult.append(vote)
    return splitresult
def chooseBestFeatureToSplit(dataSet):
    #ç‰¹å¾æ•°é‡
    numFeatures = len(dataSet[0]) - 1
    #è®¡æ•°æ•°æ®é›†çš„ç»éªŒç†µ
    baseEntropy = calcShannonEnt(dataSet)
    #ä¿¡æ¯å¢ç›Š
    bestInfoGain = 0.0
    #æœ€ä¼˜ç‰¹å¾çš„ç´¢å¼•å€¼
    bestFeature = -1
    #éå†æ‰€æœ‰ç‰¹å¾
    for i in range(numFeatures):
        # è·å–dataSetçš„ç¬¬iä¸ªæ‰€æœ‰ç‰¹å¾
        featList = [example[i] for example in dataSet]
        #exampleæ˜¯datasetçš„æ¯ä¸€è¡Œï¼Œå› ä¸ºæ˜¯ç‰¹å¾æ•°iï¼Œåˆ—æ•°ï¼Œæ‰€ä»¥ä¼šæŠŠæ¯ä¸€è¡Œçš„é‚£ä¸€åˆ—æ”¾åœ¨featlistä¸­ç„¶åi++
        Label=[example[-1]for example in dataSet]
        featList=featList.append(Label)
        #åˆ›å»ºseté›†åˆ{}ï¼Œå…ƒç´ ä¸å¯é‡å¤
        uniqueVals={}
        uniqueVals = set(featList)
        newEntropy=0
        for value in  uniqueVals:
            #subDataSetåˆ’åˆ†åçš„å­é›†
            subdataset = splitDataSet(featList, value)
            #è®¡ç®—å­é›†çš„æ¦‚ç‡
            prob = len(subdataset) / len(dataSet)
            #æ ¹æ®å…¬å¼è®¡ç®—ç»éªŒæ¡ä»¶ç†µ
            newEntropy += prob * calEnt((subdataset))
        #ä¿¡æ¯å¢ç›Š
        infoGain = baseEntropy - newEntropy
        if (infoGain > bestInfoGain):
            #æ›´æ–°ä¿¡æ¯å¢ç›Šï¼Œæ‰¾åˆ°æœ€å¤§çš„ä¿¡æ¯å¢ç›Š
            bestInfoGain = infoGain
            #è®°å½•ä¿¡æ¯å¢ç›Šæœ€å¤§çš„ç‰¹å¾çš„ç´¢å¼•å€¼
            bestFeature = i
            #è¿”å›ä¿¡æ¯å¢ç›Šæœ€å¤§ç‰¹å¾çš„ç´¢å¼•å€¼
    return bestFeature
```

- æ¥ä¸‹æ¥å°±æ˜¯ç§æ ‘çš„å‡½æ•°ï¼Œéœ€è¦ä¸æ–­é€’å½’è‡ªèº«ï¼Œä¹ŸåŒ…æ‹¬å¾ˆå¤šæƒ…å†µçš„åˆ¤æ–­ï¼Œä¸»æ¡†æ¶æ˜¯  **If-then**

```python
import operator
#ç»Ÿè®¡classlistä¸­å‡ºç°æ¬¡æ•°æœ€å¤šçš„å…ƒç´ ï¼ˆç±»æ ‡ç­¾ï¼‰
def majorityCnt (classlist):
    classcount={}
    #ç»Ÿè®¡classlistä¸­æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°
    for vote in classlist:
        classcount[vote]=0
        classcount[vote]+=1
        #æ ¹æ®å­—å…¸çš„å€¼é™åºæ’åˆ—
        sortedclasscount=sorted(classcount.items(),key=operator.itemgetter(1),reverse=True)
        return sortedclasscount[0][0]
def splitDataSet(dataSet,axis,value):
    #å»æ‰axisç‰¹å¾
    #åˆ›å»ºè¿”å›çš„æ•°æ®é›†åˆ—è¡¨
    retDataSet=[]
    #éå†æ•°æ®é›†
    for featVec in dataSet:
        if featVec[axis]==value:
            #å»æ‰axisç‰¹å¾
            reduceFeatVec=featVec[:axis]
            #å°†ç¬¦åˆæ¡ä»¶çš„æ·»åŠ åˆ°è¿”å›çš„æ•°æ®é›†
            reduceFeatVec.extend(featVec[axis+1:])
            retDataSet.append(reduceFeatVec)
    #è¿”å›åˆ’åˆ†åçš„æ•°æ®é›†
    return retDataSet
def planttree (dataset,labels,featlabels):
    #å–åˆ†ç±»æ ‡ç­¾
    classlist=[example[-1] for example in dataset]
    #æŒ‰ç…§è¯¾æœ¬çš„ç®—æ³•é€»è¾‘
    #å¦‚æœç±»åˆ«ç›¸åŒï¼Œåœæ­¢ç»§ç»­åˆ’åˆ†
    if classlist.count(classlist[0])==len(classlist):
        return classlist[0]
    #éå†å®Œæ‰€æœ‰ç‰¹å¾æ—¶è¿”å›æ¬¡æ•°æœ€å¤šçš„ç±»æ ‡ç­¾
    if len(dataset[0])==1:
        return majorityCnt(classlist)
    #é€‰æ‹©æœ€ä¼˜ç‰¹å¾
    bestfeature= chooseBestFeatureToSplit(dataset)
    #æ‰¾åˆ°æœ€ä¼˜ç‰¹å¾çš„æ ‡ç­¾
    bestfeaturelabel=labels[bestfeature]
    featlabels.append(bestfeaturelabel)
    #ç”Ÿæˆæ ‘
    Tree={bestfeaturelabel:{}}
    #åˆ é™¤å·²ç»é€‰æ‹©çš„æ ‡ç­¾
    del(labels[bestfeature])
    #è·å¾—è®­ç»ƒé›†ä¸­æ‰€æœ‰æœ€ä¼˜ç‰¹å¾çš„å±æ€§å€¼
    featurevalues=[example[bestfeature] for example in dataset]
    #åˆ é™¤é‡å¤çš„å±æ€§å€¼
    uniquevalues=set(featurevalues)    
    for value in uniquevalues:
        Tree[bestfeaturelabel][value]=planttree (splitDataSet(dataset,bestfeature,value),labels,featlabels)
```

##### å†³ç­–æ ‘çš„é¢„å‰ªæ

**åˆ†ä¸ºé¢„å‰ªæå’Œåå‰ªæï¼Œå‰ªæè¢«ç§°åšæ³›åŒ–è¿‡ç¨‹**

- åå‰ªææ¯”è¾ƒå®¹æ˜“ç†è§£ï¼š

é¦–å…ˆæœ‰è¡¡é‡æ˜¯å¦å‰ªæçš„æ ‡å‡†ï¼šæŸå¤±å‡½æ•°
$$
C_Î±(T)=\sum\limits^{|T|}_{t=1}N_tH_t(T)+Î±{|T|}
$$

- Tæ˜¯å¶å­èŠ‚ç‚¹ï¼ŒH_t(T)æ˜¯ç¬¬tä¸ªå¶å­èŠ‚ç‚¹çš„ç†µ

ä»å¶å­èŠ‚ç‚¹å¼€å§‹é€’å½’ï¼Œè®°å…¶çˆ¶èŠ‚ç‚¹å°†æ‰€æœ‰å­èŠ‚ç‚¹å›ç¼©åçš„å­æ ‘ä¸ºTbï¼ˆåˆ†ç±»å€¼å–ç±»åˆ«æ¯”ä¾‹æœ€å¤§çš„ç‰¹å¾å€¼ï¼‰ï¼Œæœªå›ç¼©çš„å­æ ‘ä¸ºTaï¼Œå¦‚æœC Î± ( T a ) â‰¥ C Î± ( T b ) å›ç¼©åä½¿å¾—æŸå¤±å‡½æ•°å‡å°äº†ï¼Œé‚£ä¹ˆåº”è¯¥ä½¿è¿™æ£µå­æ ‘å›ç¼©ï¼Œé€’å½’ç›´åˆ°æ— æ³•å›ç¼©ä¸ºæ­¢ã€‚


**wait**





#### æœ´ç´ è´å¶æ–¯

ç›®æ ‡ï¼šç®€å•æ¥è¯´ï¼šæŒ‰ç…§å·²æœ‰æ•°æ®é›†ï¼Œå­¦å¾—è”åˆæ¦‚ç‡åˆ†å¸ƒï¼Œå¯¹ç»™å®šè¾“å…¥xæ±‚å‡ºåéªŒæ¦‚ç‡æœ€å¤§çš„è¾“å‡ºã€‚

å…·ä½“ï¼šå…ˆéªŒæ¦‚ç‡åˆ†å¸ƒå’Œæ¡ä»¶æ¦‚ç‡åˆ†å¸ƒ

ï¼ˆè¿™æ ·æ¯”è¾ƒå®¹æ˜“ç†è§£è´å¶æ–¯å…¬å¼ï¼‰

![](https://s4.ax1x.com/2022/01/27/7vAp1s.png)

è€Œæˆ‘ä»¬çš„æœ´ç´ è´å¶æ–¯ç®—æ³•å°±æ˜¯è¦é€šè¿‡ç»™å®šæ•°æ®é›†å…ˆå­¦å¾—**P(X,Y)**,
$$
P(X,Y)=P(Y)P(X|Y)
$$
å…¶ä¸­ï¼š**P(Y)**æ˜¯å…ˆéªŒæ¦‚ç‡ï¼Œ**P(X|Y)**æ˜¯æ¡ä»¶æ¦‚ç‡ï¼ˆåéªŒæ¦‚ç‡ï¼‰

- å…ˆç®—éªŒæ¦‚ç‡ï¼ˆå…¬å¼ï¼‰ï¼š

$$
P(Y=c_k)=\sum\limits^N_{i=1}\frac{I(y_i=c_k)}{N},k=1,2,...,K
$$

- åéªŒæ¦‚ç‡ï¼ˆå…¬å¼ï¼‰ï¼š

$$
P(X^{j}=a_{ij}|Y=c_k)=\frac{\sum\limits^N_{i=1}I(x_i^{(j)}=a_{jl},y_i=c_k)}{\sum\limits^N_{i=1}I(y_i=c_k)}
$$

$$
j=1,2,...,n;l=1,2,...,S_j;k=1,2,...,K
$$

- å†æ ¹æ®ç»™å®šçš„x=(x^(1),x^(2),,...,x^(n))^T,è®¡ç®—ï¼š

$$
P(Y=c_k)\prod^n_{j=1}P(X^{(j)}=x^{i}|Y=c_k),k=1,2,...K
$$

- æœ€åç¡®å®šå®ä¾‹xçš„ç±»,æ±‚å‡ºyæ¦‚ç‡æœ€å¤§çš„å€¼ï¼š

$$
y=argmax_{c_k}P(Y=c_k)\prod^n_{j=1}P(X^{(j)}=x^{i}|Y=c_k)
$$

**ä¾‹å­**

![](https://s4.ax1x.com/2022/01/27/7vn8Et.png)

![](https://s4.ax1x.com/2022/01/27/7vnEAx.png)

æ ¹æ®åæ¥è¦æµ‹å®šçš„xçš„å·²æœ‰å–å€¼æ¥æµ‹å®šè¿™ç§æƒ…å†µä¸‹ï¼Œyæœ€å¤§å¯èƒ½æ˜¯ä»€ä¹ˆå€¼ï¼›æ¯”è¾ƒç®€å•çš„æ¦‚ç‡æ¨¡å‹



![](https://s4.ax1x.com/2022/01/28/7zSpCR.png)



**ä»£ç å®ç°ï¼š**

```python
#å¯¹äºæ•°æ®é›†ï¼Œéœ€è¦æŠŠxï¼Œyæ‹‰å–å‡ºæ¥ï¼Œxé‡Œé¢åŒ…å«ç‰¹å¾ï¼Œyå°±æ˜¯è¦é¢„æµ‹çš„å€¼
```

- **é¦–å…ˆæ˜¯æ ¹æ®å·²ç»æœ‰çš„æ•°æ®é›†ï¼Œæ±‚å‡ºå…ˆéªŒæ¦‚ç‡å’ŒåéªŒæ¦‚ç‡**

```python
def Bayes_Second(i,j,x_y_counts,y_value_count):
    p_x_y=dict()
    for k in x_y_counts.index:
        #æŒ‰ç…§å…¬å¼
        #iå¯¹åº”xçš„ç‰¹å¾ï¼Œjå¯¹åº”yçš„å–å€¼
        p_x_y[(i,k,j)]=x_y_counts[k]/y_value_count
    return p_x_y
def Bayes_First(x,y):
    #éœ€è¦çŸ¥é“yæœ‰å¤šå°‘å–å€¼ï¼Œä¸”éœ€è¦çŸ¥é“æ¯ä¸€ç§å–å€¼å„è‡ªæœ‰å¤šå°‘
    y_values=y[y.columns[0]].unique()
    y_value_count=y[y.columns[0]].value_counts()
    #unique()æ˜¯æ‰¾å‡ºä¸€å…±æœ‰å¤šå°‘å–å€¼çš„å‡½æ•°
    #value_counts()æ˜¯æ‰¾å‡ºæ¯ä¸€ç§å–å€¼æœ‰å¤šå°‘ä¸ªçš„å‡½æ•°
    p_y_ck=y_value_count/len(y_values)
    #ç„¶åæ±‚xæ¯ä¸€ç§ç‰¹å¾çš„æ¯ä¸€ç§å–å€¼åœ¨ç±»å†…çš„æ¯”ä¾‹
    for i in x.columns:
        #éœ€è¦çŸ¥é“æ¯ä¸€ç§yçš„å–å€¼xçš„æŸä¸ªç‰¹å¾çš„å–å€¼ä»¬å„å å¤šå°‘
        for j in y_values:
            x_y_counts=x[(y==j).values][i].values.count_count()
            p_x_y=Bayes_Second(i,j,x_y_counts,y_value_count)
    return y_values,p_y_ck,p_x_y
```



- **æœ€åæ˜¯é¢„æµ‹å‡ºyæœ€å¤§å¯èƒ½çš„å€¼**

```python
import numpy as np
def y_max_predict(X,y_values,p_y_ck,p_x_y):
    y_results=[]
    for i in y_values:
        p_y=p_y_ck[i]
        p_X_y=0
        for j in X.items():
            p_X_y*=p_x_y[tuple(list(j)+[i])]
        y_results.append(p_y*p_X_y)   
    return y_values[np.argmax(y_results)]
```

(æ–°çš„æ”¶è·çš„å‡½æ•°ç›¸å…³çŸ¥è¯†è¡¥åœ¨å¦ä¸€ä¸ª`md`æ–‡ä»¶)







#### ç¥ç»ç½‘ç»œ

##### ä»£ä»·å‡½æ•°

é€»è¾‘å›å½’çš„ä»£ä»·å‡½æ•°ï¼š
$$
J(theta)=\frac{-1}{m}\begin{bmatrix} \sum\limits^m_{i=1}y^{i}logh_{theta}(x^{(i)})+(1-y^{(i)})log(1-h_{theta}(x^{(i)}))\end{bmatrix}
$$
ç¥ç»ç½‘ç»œçš„ä»£ä»·å‡½æ•°ï¼š

- å› ä¸ºç¥ç»ç½‘ç»œçš„æ ·æœ¬ç»“æœæ˜¯å¤šä¸ªï¼Œåˆ™éœ€è¦æŒ‰ç…§æ¯ä¸€ä¸ªç»“æœç±»åˆ«å¾€å›æ‰¾ï¼Œè®©æ¯ä¸€ä¸ªçš„ä»£ä»·å‡½æ•°éƒ½æœ€å°

$$
h_{theta}(x)\in\R^K,(h_{theta}(x))_{i}=i^{th}output
$$

$$
J(theta)=\frac{-1}{m}\begin{bmatrix} \sum\limits^m_{i=1}\sum\limits ^K_{k=1}y^{i}_klog(h_{theta}(x^{(i)}))_k+(1-y^{(i)})log(1-(h_{theta}(x^{(i)}))_k)\end{bmatrix}
$$

å¯¹å‚æ•°è¿›è¡Œæœ€ä¼˜å€¼æ›´æ–°ï¼Œä¾æ®å°±æ˜¯ä»£ä»·å‡½æ•°æœ€å°

æ³¨æ„ï¼Œéœ€è¦æ’é™¤æ¯ä¸€å±‚çš„theta_0,æ¯ä¸€å±‚thetaçŸ©é˜µå¹³æ–¹å’Œã€‚

##### åå‘ä¼ æ’­

**ä¸ºäº†æœ€å°åŒ–ä»£ä»·å‡½æ•°ï¼Œéœ€è¦æ±‚åå¯¼**

![](https://s4.ax1x.com/2022/02/07/HMggTf.png)

**æä¾›åå‘ä¼ æ’­ç®—æ³•ï¼š**

![](https://s4.ax1x.com/2022/02/07/HMg7mq.png)

###### æµç¨‹ï¼š

- **é¦–å…ˆ**è®¡ç®—æœ€åä¸€å±‚çš„è¯¯å·®:ğ›¿_(4)=a_(4)-y

$$
ğ›¿^{(l)}_jè¡¨ç¤ºç¬¬lå±‚ç¬¬jä¸ªå•å…ƒçš„è¯¯å·®
$$

- ç„¶åç»§ç»­å‘å·¦æ±‚å‡ºå„å±‚çš„è¯¯å·®ï¼Œç›´åˆ°å€’æ•°ç¬¬2å±‚ï¼ˆç¬¬ä¸€å±‚æ˜¯è¾“å…¥å˜é‡ï¼Œä¸å­˜åœ¨è¯¯å·®ï¼‰





###### è®¡ç®—å„å±‚è¯¯å·®çš„å…¬å¼ï¼š

- ç¬¬**å››**å±‚è¯¯å·®æ˜¯æ¿€æ´»å•å…ƒçš„é¢„æµ‹aä¸å®é™…å€¼yä¹‹é—´çš„è¯¯å·®

$$
ğ›¿_j^{(4)}=a_j^{(4)}-y_j
$$

â€‹       å…¶ä¸­:
$$
a_j^{(4)}=(h_{theta}^{(x)})_j
$$

- ç¬¬**ä¸‰**å±‚è¯¯å·®ï¼š

$$
ğ›¿(3) = (ğ›©^{(3)})^ğ‘‡ğ›¿^{(4)} âˆ— ğ‘”â€²(ğ‘§^{(3)})
$$

â€‹       å…¶ä¸­ï¼š

â€‹       (ğœƒ(3))^ğ‘‡ğ›¿^(4)æ˜¯æƒé‡å¯¼è‡´çš„**è¯¯å·®çš„å’Œ**ï¼› ğ‘”â€²(ğ‘§^(3))æ˜¯æ¿€æ´»å‡½æ•°ï¼ˆsigmoid)çš„å¯¼æ•°ï¼Œä¸”       sigmoidå‡½æ•°çš„å¯¼æ•°æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼š
$$
ğ‘”â€²(ğ‘§^{(3)}) = ğ‘^{(3)}âˆ—(1âˆ’ğ‘^{(3)})
$$

- å€’æ•°ç¬¬2å±‚:

$$
ğ›¿(2) = (ğ›©^{(2)})^ğ‘‡ğ›¿^{(3)} âˆ— ğ‘”â€²(ğ‘§^{(2)})
$$

- æœ‰äº†è¯¯å·®ï¼Œå°±å¯ä»¥å¼€å§‹è®¡ç®—ä»£ä»·å‡½æ•°çš„åå¯¼ï¼š

![](https://s4.ax1x.com/2022/02/07/HMWMY8.png)

Lï¼šè¡¨ç¤ºç›®å‰æ˜¯ç¬¬å‡ å±‚

jï¼šè¡¨ç¤ºå±‚å†…çš„æ¿€æ´»å•å…ƒä¸‹æ ‡ï¼ˆå‘å·¦ï¼Œ**ä¸‹ä¸€å±‚ç¬¬jä¸ªè¾“å…¥å˜é‡**çš„ä¸‹æ ‡ï¼‰

iï¼šä¸‹ä¸€å±‚è¯¯å·®å•å…ƒçš„ä¸‹æ ‡ï¼ˆå‘å·¦ï¼Œå—åˆ° æƒé‡çŸ©é˜µä¸­ç¬¬iè¡Œ å½±å“çš„ä¸‹ä¸€å±‚è¯¯å·®çš„ä¸‹æ ‡ï¼‰



###### å´æ°¸æ©çš„ä¼ªä»£ç å®ç°

![](https://s4.ax1x.com/2022/02/07/HMfdHI.png)

æ¥ç€è¿›è¡Œä»£ä»·å‡½æ•°çš„åå¯¼æ•°è®¡ç®—ï¼š

Dè¡¨ç¤ºæ¢¯åº¦

![](https://s4.ax1x.com/2022/02/07/HMfy8S.png)

###### å±•å¼€å‚æ•°

çœŸæ­£å®ç°çš„æ—¶å€™æ³¨æ„çŸ©é˜µï¼Œå‘é‡ä¹‹é—´çš„è½¬åŒ–



##### æ¢¯åº¦æ£€æµ‹

å¯¹äºé€»è¾‘å›å½’ï¼Œæˆ‘ä»¬åˆå§‹åŒ–å‚æ•°Î¸ä¸º0ï¼Œä½†æ˜¯ç¥ç»ç½‘ç»œä¸èƒ½åˆå§‹åŒ–ç›¸åŒçš„å€¼ï¼Œå› ä¸ºå¦‚æœç¬¬ä¸€å±‚å‚æ•°ç›¸åŒï¼Œæ„å‘³ç€ç¬¬äºŒå±‚æ‰€æœ‰æ¿€æ´»å•å…ƒçš„å€¼ä¼šå®Œå…¨ç›¸åŒ



å–Î¸ç‚¹å·¦å³å„ä¸€ç‚¹ï¼ˆÎ¸+Îµï¼‰,ï¼ˆÎ¸-Îµï¼‰ï¼Œåˆ™ç‚¹Î¸çš„å¯¼æ•°ï¼ˆæ¢¯åº¦ï¼‰è¿‘ä¼¼ç­‰äº(J(Î˜+Îµ)-J(Î¸-Îµ))/(2Îµ)ã€‚

![](https://s4.ax1x.com/2022/02/07/HM4Ymd.png)

å› æ­¤ï¼Œé’ˆå¯¹æ¯ä¸ªÎ¸ï¼Œå¯¼æ•°çš„è¿‘ä¼¼å€¼ï¼š

![](https://s4.ax1x.com/2022/02/07/HM4Bp8.png)

**ä¼ªä»£ç ï¼š**

å°†è¿™ä¸ªè¿‘ä¼¼å€¼å’Œåå‘ä¼ æ’­æ¯ä¸€æ­¥å¾—åˆ°çš„ j çš„å¯¼æ•°Dè¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç»“æœç›¸è¿‘ï¼Œé‚£ä¹ˆä»£ç æ­£ç¡®

![](https://s4.ax1x.com/2022/02/07/HM4fhV.png)



**éšæœºåˆå§‹åŒ–å‚æ•°ï¼š**

![](https://s4.ax1x.com/2022/02/07/HMhci6.png)

##### ç»¼åˆ

æ­£å¸¸æƒ…å†µä¸‹ï¼Œéšè—å±‚å•å…ƒè¶Šå¤šè¶Šå¥½ï¼Œä½†æ˜¯è¿™æ ·æ— ç–‘ä¹Ÿä¼šè®©è®¡ç®—é‡å¢å¤§ã€‚æ‰€ä»¥é€‰æ‹©å¥½é€‚åˆçš„ç¥ç»ç½‘ç»œç»“æ„è‡³å…³é‡è¦



è®­ç»ƒç¥ç»ç½‘ç»œï¼š

1. å‚æ•°çš„éšæœºåˆå§‹åŒ–
2.  åˆ©ç”¨**æ­£å‘ä¼ æ’­**æ–¹æ³•è®¡ç®—æ‰€æœ‰çš„ â„ğœƒ(ğ‘¥)ã€
3.  ç¼–å†™è®¡ç®—ä»£ä»·å‡½æ•° ğ½ çš„ä»£ç ï¼Œåœ¨æ­£å‘ä¼ æ’­è®¡ç®—å‡ºhxçš„åŒæ—¶æ±‚å‡ºä»£ä»·å‡½æ•°
4.  åˆ©ç”¨**åå‘ä¼ æ’­**æ–¹æ³•è®¡ç®—æ‰€æœ‰åå¯¼æ•°ï¼ˆæ±‚å‡ºæ¢¯åº¦Dï¼‰
5.  åˆ©ç”¨**æ•°å€¼æ£€éªŒ**ï¼ˆæ¢¯åº¦æ£€æµ‹ï¼‰æ–¹æ³•è¿™äº›åå¯¼
6. ä½¿ç”¨ä¼˜åŒ–ç®—æ³•æ¥æœ€å°ä»£ä»·å‡½æ•°ï¼Œæ±‚å¾—æœ€ä½³å‚æ•°ğœƒ



![](https://s4.ax1x.com/2022/02/07/HM5KBj.png)

##### ä»£ç å®ç°ï¼š



